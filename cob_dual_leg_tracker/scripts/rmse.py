import random
import matplotlib.pyplot as plt
import itertools
import numpy as np
import os
from matplotlib.gridspec import GridSpec

plt.close('all')

name_lst = []
error_lst = []
rmse_lst = []

def getRMSE(error):
    rmse = []
    error_square_sum = 0;
    for e in error:
        error_square_sum += np.power(e,2);
        rmse.append(np.sqrt(error_square_sum / (len(rmse)+1)))
        
    return rmse
    
def plotErrorPlot(name,error,rmse):
    
    #calculate the time
    time = np.arange(0,len(error)*0.08, 0.08)    
    
    return plotErrorPlotWithTime(name,error,rmse,time)
    
def plotErrorPlotWithTime(name,error,rmse,t):
    print name
    
    # trim the rmse
    rmse = rmse[0:len(error)]
    
    # trim the time
    t = t[0:len(error)]    
    
    initialTime = t[0]    
    t[:] = [x - initialTime for x in t]
    
    # Get the figure
    fig = plt.figure(figsize=(15,5))
    gs = GridSpec(100,100,bottom=0.18,left=0.18,right=0.88)
    
    axarr = []
    
    axarr[]0 = fig.add_subplot(gs[:,0:60])

    # designate ax2 to span all rows, 
    ax2 = fig.add_subplot(gs[:,75:99])
    
    #plot
    axarr[0].plot(t[0:len(error)],getRMSE(error),'r.-', markersize = 10, label="RMSE")
    axarr[0].set_title("Root mean squared error", fontsize=15)
    axarr[0].set_ylim(0,max(error)*1.8)
    axarr[0].set_xlim(0,max(t))

    axarr[0].plot(t[0:len(error)],error,'b.-', markersize = 10, label="Translational Error")
    axarr[0].legend(loc="upper left", prop={'size':12})
    axarr[0].set_xlabel('Time[s]')
    axarr[0].set_ylabel('||e|| [m]')

    #plt.subplots_adjust(left=None, bottom=None, right=None, top=2, wspace=None, hspace=0.75)

    bp = axarr[1].boxplot(error)
    axarr[1].set_title("Error distribution", fontsize=15)
    axarr[1].set_xticklabels([])
    axarr[1].set_ylim(0,max(error)*1.1)
    axarr[1].set_ylabel('||e|| [m]')
    median =  bp['medians'][0].get_ydata()[0]
    print median
    axarr[1].text(1, median, median, fontsize = 9, color="red", backgroundcolor="white",clip_on=True, horizontalalignment='center', verticalalignment='center')
    
    plt.suptitle(name, fontsize = 20)
    plt.subplots_adjust(left=None, bottom=None, right=None, top=0.85, wspace=None, hspace=0.6)
    
    return axarr
    
def saveResult():
    savefig('./output/'+os.path.splitext(name)[0]+'.pdf', bbox_inches='tight')

    

name = "precision_tests_sidestep.bag"
error = [0.018269,0.049218,0.084285,0.151717,0.132744,0.098061,0.088778,0.075499,0.077983,0.058448,0.062879,0.006717,0.017240,0.038715,0.018431,0.008940,0.040799,0.063175,0.130554,0.144597,0.178847,0.179490,0.249745,0.150076,0.117589,0.129049,0.180357,0.203334,0.173676,0.209046,0.134303,0.122773,0.119310,0.220411,0.246249,0.246249,0.178907,0.126421,0.035580,0.038200,0.038200]
rmse = [0.018269,0.037123,0.057330,0.090662,0.100498,0.100096,0.098559,0.095980,0.094150,0.091211,0.089009,0.085242,0.082037,0.079727,0.077170,0.074753,0.073193,0.072673,0.076815,0.081553,0.088642,0.094681,0.106239,0.108420,0.108801,0.109649,0.113059,0.117484,0.119861,0.123873,0.124223,0.124178,0.124033,0.127909,0.132762,0.137188,0.138481,0.138177,0.136513,0.134931,0.133409,0.136322,0.148769,0.169273,0.194275,0.219423,0.256005,0.294624,0.332479,0.369749,0.405012,0.439196,0.480880,0.522779,0.567845,0.616309,0.666455,]
time = [1436863617.346435549,1436863617.425429606,1436863617.582367390,1436863617.661361611,1436863617.740363920,1436863617.819383609,1436863617.897364169,1436863617.976360706,1436863618.055377889,1436863618.134496980,1436863618.291375217,1436863618.370401104,1436863618.449361231,1436863618.527383493,1436863618.606366934,1436863618.687751715,1436863618.763410270,1436863618.842359482,1436863618.920401296,1436863618.999370725,1436863619.078384040,1436863619.157440107,1436863619.235367683,1436863619.393379577,1436863619.472381873,1436863619.550402709,1436863619.629420841,1436863619.708398394,1436863619.787375005,1436863619.865362950,1436863620.023440867,1436863620.101374835,1436863620.180363782,1436863620.259407560,1436863620.338392417,1436863620.416411500,1436863620.495381612,1436863620.574395277,1436863620.653374043,1436863620.731382269,1436863620.810390216,1436863620.967382056,1436863621.046382492,1436863621.125376624,1436863621.203435848,1436863621.282384272,1436863621.440388830,1436863621.519391432,1436863621.597443381,1436863621.676418836,1436863621.755385944,1436863621.834618382,1436863621.913371307,1436863621.992397161,1436863622.071664146,1436863622.150397078,1436863622.229376784,]
axarr = plotErrorPlotWithTime(name,error,rmse,time)
axarr[0].axvspan(1.5, 2.1, color='gray', alpha=0.5)
axarr[0].text((1.5+2.1)/2, max(error)*1.5*0.9, "sidestep", fontsize = 12, horizontalalignment='center')

axarr[0].axvspan(2.2, 3.2, color='gray', alpha=0.5)
axarr[0].text((2.2+3.2)/2, max(error)*1.5*0.9, "acceleration", fontsize = 12, horizontalalignment='center')
saveResult()


name = "precision_tests_walk_and_stop01.bag" # ppl1_2
error = [0.077488,0.063827,0.114025,0.163046,0.160125,0.163116,0.145631,0.122450,0.095190,0.095989,0.121762,0.130394,0.090854,0.127517,0.089731,0.085024,0.085359,0.089850,0.112427,0.132044,0.147790,0.134208,0.129546,0.139438,0.140025,0.126465,0.127950,0.121908,0.116629,0.103469,0.090655,0.077873,0.070231,0.069671,0.078369,0.081501,0.086976,0.081662,0.103950,0.113182,0.119392,0.118836,0.124689,0.146233,0.156780,0.161684,0.155082,0.154105,0.155518,0.183386,0.184050,0.168910]
rmse = [0.077488,0.070987,0.087712,0.111427,0.122722,0.130327,0.132622,0.131393,0.127878,0.125055,0.124759,0.125239,0.122936,0.123269,0.121321,0.119377,0.117648,0.116278,0.116079,0.116929,0.118581,0.119335,0.119798,0.120680,0.121513,0.121707,0.121944,0.121942,0.121763,0.121198,0.120334,0.119236,0.118050,0.116913,0.115990,0.115171,0.114501,0.113758,0.113517,0.113509,0.113656,0.113782,0.114047,0.114879,0.115975,0.117158,0.118092,0.118954,0.119811,0.121410,0.122945,0.123990,0.127780,0.128635,0.128825,0.129038,0.129133,0.129129,0.128961,0.129860,0.139881,0.152911,0.167850,0.183775,0.202875,0.226578,0.254154,0.280879,0.307033,0.332479,0.356945,]
time = [1436863677.838593049,1436863677.916614816,1436863677.995599041,1436863678.074595534,1436863678.152591155,1436863678.231733383,1436863678.310593444,1436863678.389618693,1436863678.467588045,1436863678.546589771,1436863678.625597423,1436863678.703594617,1436863678.782602710,1436863678.861592825,1436863679.097582876,1436863679.176594394,1436863679.255614091,1436863679.334756405,1436863679.412603479,1436863679.491604649,1436863679.570595926,1436863679.648590201,1436863679.727799058,1436863679.806611662,1436863679.885588874,1436863680.042604881,1436863680.121602531,1436863680.200624459,1436863680.279606844,1436863680.436611517,1436863680.515596411,1436863680.594602496,1436863680.672608291,1436863680.751708086,1436863680.830597059,1436863680.987600517,1436863681.066594187,1436863681.145593043,1436863681.302627599,1436863681.381606319,1436863681.460604645,1436863681.539625542,1436863681.618635017,1436863681.779777572,1436863681.854602683,1436863681.933610666,1436863682.012605975,1436863682.091606848,1436863682.170607854,1436863682.249602614,1436863682.327620513,1436863682.406606158,1436863682.722615716,1436863682.800607959,1436863682.879602137,1436863682.958615150,1436863683.115599993,1436863683.194622717,1436863683.273604122,1436863683.352600302,1436863683.509601882,1436863683.588791646,1436863683.667601315,1436863683.745611637,1436863683.824627810,1436863683.903625470,1436863683.982639230,1436863684.060628586,1436863684.139623157,1436863684.218698652,1436863684.297618733,]
axarr = plotErrorPlotWithTime(name,error,rmse,time)
axarr[0].axvspan(2.3, 3.6, color='gray', alpha=0.5)
axarr[0].text((2.3+3.6)/2, max(error)*1.5*0.9, "stop", fontsize = 12, horizontalalignment='center')
saveResult()


name = "precision_tests_walk_and_stop03.bag"
error = [0.102391,0.110971,0.086679,0.067319,0.113915,0.172460,0.131157,0.132264,0.107291,0.122251,0.132387,0.104555,0.105638,0.094775,0.093456,0.112457,0.105869,0.098090,0.134558,0.129130,0.134056,0.134056,0.129008,0.162420,0.172069,0.163016,0.160665,0.134076,0.123057,0.123718,0.114959,0.102325,0.088911,0.080336,0.074086,0.074369,0.073566,0.080346,0.081448,0.090422,0.112221,0.115548,0.135805,0.153686,0.164699,0.202248,0.221338,0.208413,0.189461,0.173104,0.160271,0.140129,0.139784,0.135165]
rmse = [0.102391,0.106767,0.100518,0.093332,0.097796,0.113698,0.116352,0.118458,0.117270,0.117778,0.119180,0.118030,0.117124,0.115670,0.114324,0.114208,0.113734,0.112922,0.114163,0.114958,0.115939,0.116823,0.117379,0.119595,0.122128,0.123950,0.125502,0.125818,0.125724,0.125657,0.125326,0.124672,0.123740,0.122683,0.121564,0.120503,0.119477,0.118613,0.117807,0.117200,0.117081,0.117045,0.117515,0.118460,0.119682,0.122072,0.125007,0.127304,0.128872,0.129905,0.130568,0.130758,0.130934,0.131424,0.132663,0.134009,0.136326,0.137021,0.138743,0.140449,0.140062,0.139254,0.139387,0.139693,0.139502,]
time = [1436863731.642810604,1436863731.721801743,1436863731.800805143,1436863731.878813683,1436863731.957802281,1436863732.036828160,1436863732.114798104,1436863732.193800301,1436863732.272794347,1436863732.350798698,1436863732.429857073,1436863732.586814263,1436863732.665793615,1436863732.822816077,1436863732.901810453,1436863733.137795512,1436863733.296028421,1436863733.373804565,1436863733.452806308,1436863733.531991194,1436863733.610935608,1436863733.689822125,1436863733.768804438,1436863733.847809111,1436863733.926804239,1436863734.005817331,1436863734.083805406,1436863734.162818489,1436863734.241813823,1436863734.320833843,1436863734.398805172,1436863734.477811840,1436863734.556809903,1436863734.635875589,1436863734.714817600,1436863734.793939060,1436863734.872812170,1436863734.950845767,1436863735.030145174,1436863735.108809038,1436863735.187846715,1436863735.266806729,1436863735.344828063,1436863735.423819215,1436863735.502814631,1436863735.660818705,1436863735.738869592,1436863735.817813415,1436863735.896992896,1436863735.975822685,1436863736.054826235,1436863736.132811299,1436863736.211829746,1436863736.290832269,1436863736.369807671,1436863736.448829071,1436863736.528481061,1436863736.605812074,1436863736.684876993,1436863736.764212259,1436863736.842809914,1436863736.921821800,1436863736.999821134,1436863737.078820447,1436863737.158046838,1436863737.236913241,1436863737.315920739,1436863737.393816416,1436863737.472833321,]
axarr = plotErrorPlot(name,error,rmse)
axarr[0].axvspan(2.25, 3.3, color='gray', alpha=0.5)
axarr[0].text((2.25+3.3)/2, max(error)*1.5*0.9, "stop", fontsize = 12, horizontalalignment='center')
axarr[0].axvspan(3.4, 4.0, color='gray', alpha=0.5)
axarr[0].text((3.4+4.0)/2, max(error)*1.5*0.9, "acceleration", fontsize = 12, horizontalalignment='center')
saveResult();



name = "precision_tests_walk_fast01.bag"
error = [0.100240,0.072210,0.105455,0.181113,0.277641,0.020390,0.031330,0.026602,0.049177,0.068286,0.085589,0.169023,0.273029,0.380618,0.105413,0.095152,0.109800,0.151825,0.122713,0.103301,0.092757,0.097297,0.135027,0.162970,0.150288,0.087549]
rmse = [0.100240,0.087356,0.093778,0.121640,0.165087,0.150933,0.140238,0.131517,0.125074,0.120605,0.117852,0.122933,0.140300,0.169192,0.165706,0.162198,0.159593,0.159171,0.157463,0.155204,0.152810,0.150731,0.150083,0.150642,0.150627,0.148697,0.148521,0.151749,0.158781,0.166649,0.182455,0.199490,]
plotErrorPlot(name,error,rmse)
saveResult();

name = "precision_tests_walk_fast01_curve.bag"
error = [0.050744,0.111080,0.172071,0.221365,0.264416,0.174613,0.219718,0.148399,0.143342,0.102657,0.097612,0.168628,0.134326,0.089159,0.117401,0.039678,0.044760,0.045402,0.110034,0.110475,0.117266,0.107703,0.101319,0.117410,0.164262,0.155366,0.204309,0.165825,0.084727,0.029635,0.166935,0.177314,0.107481,0.138193,0.121002,0.133068]
rmse = [0.050744,0.086353,0.121822,0.152909,0.180799,0.179782,0.186013,0.181738,0.177881,0.171847,0.166472,0.166653,0.164392,0.160194,0.157703,0.153017,0.148845,0.145046,0.143417,0.141951,0.140874,0.139538,0.138096,0.137296,0.138476,0.139163,0.142110,0.143024,0.141415,0.139143,0.140126,0.141436,0.140528,0.140459,0.139941,0.139755,0.142786,0.146062,0.150639,0.166093,0.181480,0.200385,0.223173,0.249327,0.277015,]
plotErrorPlot(name,error,rmse)
saveResult();

name = "precision_tests_walk_fast02.bag"
error = [0.096239,0.120858,0.083389,0.115229,0.186303,0.233287,0.103559,0.118145,0.202588,0.128052,0.075854,0.149392,0.139798,0.134174,0.089649,0.137399,0.121574,0.143573,0.117509]
rmse = [0.096239,0.109244,0.101361,0.105000,0.125546,0.149014,0.143406,0.140497,0.148682,0.146749,0.141777,0.142427,0.142227,0.141667,0.138807,0.138719,0.137769,0.138098,0.137092,0.151136,0.171260,0.203670,0.235441,0.267759,0.314264,0.367073,0.422103,0.482104,0.540257,0.594617,0.646931,0.706622,0.764894,]
plotErrorPlot(name,error,rmse)
saveResult();

name = "precision_tests_walk_fast_sidestep.bag"
error = [0.131280,0.106680,0.143276,0.099896,0.190456,0.051963,0.036965,0.066379,0.013669,0.018094,0.090721,0.191026,0.200868,0.188844,0.083123,0.040040,0.038624,0.106202,0.141606,0.158513,0.177045,0.205924,0.209485,0.230997,0.209604,0.211719,0.183595,0.214097,0.212089,0.283022,0.280680,0.204662,0.181873]
rmse = [0.131280,0.119614,0.127988,0.121575,0.138127,0.127864,0.119201,0.113945,0.107525,0.102168,0.101181,0.111469,0.120720,0.126805,0.124371,0.120837,0.117603,0.116999,0.118421,0.120743,0.124005,0.128863,0.133386,0.138830,0.142338,0.145619,0.147200,0.150104,0.152661,0.158740,0.164095,0.165513,0.166032,0.169322,0.172108,0.177587,0.177723,0.177214,0.176605,0.180504,0.189143,0.199407,0.212431,0.230383,0.254980,0.284760,0.314437,0.343475,0.371032,0.399011,0.428432,0.460641,0.503096,0.549484,0.591372,0.635614,0.678102,0.721714,0.767129,0.815216,0.866089,0.911665,0.954864,]
plotErrorPlot(name,error,rmse)
saveResult();

name = "precision_tests_walk_medium01.bag"
error = [0.120985,0.095505,0.123202,0.071843,0.106110,0.054927,0.092373,0.096182,0.110908,0.095572,0.152514,0.115028,0.126896]
rmse = [0.120985,0.108992,0.113926,0.104999,0.105222,0.098637,0.097766,0.097570,0.099141,0.098789,0.104818,0.105706,0.107485,0.113714,0.131481,0.150491,0.237779,0.336746,0.422182,0.499004,0.587934,]
time = [1436863418.841897655,1436863418.920747756,1436863419.078751656,1436863419.236744675,1436863419.313737353,1436863419.392764517,1436863419.471799415,1436863419.549752030,1436863419.865741663,1436863419.943846451,1436863420.180743996,1436863420.259750748,1436863420.416752161,1436863420.495807917,1436863420.652746197,1436863420.731758751,1436863421.046752945,1436863421.361747689,1436863421.439782423,1436863421.518746928,1436863421.754767197,]
plotErrorPlotWithTime(name,error,rmse,time)
saveResult();

name = "precision_tests_walk_medium02.bag"
error = [0.106112,0.125697,0.153951,0.134304,0.152854,0.102970,0.098955,0.085531,0.067906,0.088566,0.139047,0.105854,0.066815,0.105883,0.163414,0.144953,0.144023,0.116431,0.118637,0.122058,0.180251,0.144124,0.083402,0.072729,0.027842,0.058601,0.058244,0.118635]
rmse = [0.106112,0.116317,0.130077,0.131147,0.135766,0.130872,0.126805,0.122409,0.117607,0.115034,0.117420,0.116500,0.113453,0.112929,0.116975,0.118916,0.120538,0.120314,0.120226,0.120318,0.123832,0.124826,0.123314,0.121627,0.119300,0.117546,0.115892,0.115991,0.118721,0.129295,0.147944,0.167763,]
plotErrorPlot(name,error,rmse)
saveResult();


name =  "precision_tests_walk_moving_bot01.bag"
error = [0.154973,0.186836,0.135225,0.103550,0.087172,0.078568,0.101258,0.144661,0.129415,0.106812,0.154031,0.094653,0.055694,0.076833,0.055742,0.102514,0.185268,0.210725,0.196502,0.162534,0.142067,0.124703,0.126184,0.166630,0.135973,0.185258,0.194830,0.188746,0.135310,0.097064,0.086080,0.101450,0.172622,0.146008,0.119106,0.044799,0.057940]
rmse = [0.154973,0.171645,0.160427,0.148267,0.138226,0.130195,0.126467,0.128882,0.128941,0.126902,0.129603,0.127059,0.123047,0.120336,0.117143,0.116283,0.121431,0.128036,0.132524,0.134184,0.134570,0.134137,0.133801,0.135328,0.135354,0.137609,0.140145,0.142167,0.141936,0.140671,0.139245,0.138220,0.139387,0.139587,0.139043,0.137302,0.135768,0.136518,0.141338,0.146363,0.155904,0.166733,0.177950,0.193598,0.214422,0.238414,0.261841,]
plotErrorPlot(name,error,rmse)
saveResult();

name = "precision_tests_walk_moving_bot02.bag"
error = [0.141986,0.149799,0.108194,0.103470,0.079579,0.043840,0.036890,0.025308,0.025627,0.067724,0.049711,0.070390,0.119691,0.168279,0.107280,0.087203,0.097426,0.088654,0.093744,0.078006,0.080620,0.130172,0.160138,0.160968,0.087344,0.072402,0.031618,0.044162,0.083626,0.064657,0.109565,0.127867,0.097315,0.051047,0.110275]
rmse = [0.141986,0.145945,0.134543,0.127487,0.119453,0.110504,0.103252,0.096997,0.091848,0.089728,0.086855,0.085604,0.088693,0.096577,0.097328,0.096726,0.096767,0.096334,0.096200,0.095373,0.094722,0.096616,0.100219,0.103465,0.102868,0.101865,0.100146,0.098695,0.098214,0.097282,0.097702,0.098784,0.098740,0.097670,0.098053,0.102374,0.107898,0.120384,0.133446,0.146544,0.162202,0.180936,0.203519,0.229992,0.257718,0.287095,]
time = [1436864058.311260615,1436864058.390478095,1436864058.469252464,1436864058.547262547,1436864058.626251329,1436864058.705263923,1436864058.784274031,1436864058.863279932,1436864058.941301075,1436864059.020290823,1436864059.098327688,1436864059.177708074,1436864059.256273291,1436864059.335269590,1436864059.413280927,1436864059.492482339,1436864059.571282965,1436864059.650286893,1436864059.729262701,1436864059.808271606,1436864059.887349190,1436864059.966275742,1436864060.044301817,1436864060.123265146,1436864060.202548567,1436864060.281284778,1436864060.359265470,1436864060.438293968,1436864060.517274954,1436864060.595320858,1436864060.674276011,1436864060.753283741,1436864060.832307753,1436864060.910262481,1436864060.989264526,1436864061.068399886,1436864061.146275297,1436864061.225319263,1436864061.304283881,1436864061.383297568,1436864061.461308584,1436864061.540270437,1436864061.619270682,1436864061.698294269,1436864061.776503616,1436864061.855325226,]
plotErrorPlot(name,error,rmse)
saveResult();

name = "precision_tests_walk_moving_bot04.bag"
error = [0.174945,0.133648,0.147331,0.168401,0.167200,0.140272,0.146783,0.092719,0.094166,0.106972,0.106364,0.127278,0.171878,0.194888,0.160592,0.163473,0.171468,0.152783,0.142282,0.141749,0.175893,0.163240,0.150999,0.131195,0.100599,0.076610,0.065855,0.064211,0.066459,0.077718,0.078054,0.078159,0.081029,0.085151,0.090186,0.100522,0.111070,0.115388,0.130621,0.147665,0.191720,0.173807,0.176392,0.180518,0.178299,0.171345,0.208095,0.208422,0.177756]
rmse = [0.174945,0.155672,0.152942,0.156950,0.159053,0.156080,0.154786,0.148453,0.143440,0.140220,0.137487,0.136666,0.139690,0.144334,0.145475,0.146664,0.148238,0.148494,0.148174,0.147859,0.149314,0.149975,0.150019,0.149283,0.147644,0.145554,0.143394,0.141332,0.139422,0.137811,0.136292,0.134856,0.133544,0.132373,0.131356,0.130598,0.130109,0.129743,0.129765,0.130243,0.132083,0.133228,0.134390,0.135612,0.136706,0.137552,0.139425,0.141206,0.142046,0.142979,0.144302,0.148604,0.148019,0.147719,0.147222,0.147252,0.148897,0.153922,0.162160,0.173990,]
plotErrorPlot(name,error,rmse)
saveResult();

name = "precision_tests_walk_occlusion01.bag"
error = [0.169414,0.161622,0.210183,0.204072,0.225504,0.100011,0.068289,0.047852,0.035463,0.064645,0.098509,0.117097,0.047209,0.078918,0.180665,0.262818,0.308808,0.348939,0.293362,0.366481,0.415656,0.498787,0.230621,0.131047,0.089285,0.121838,0.182942,0.182877,0.172787,0.023818,0.032251,0.073905,0.088944,0.094213,0.104945,0.133971,0.098341,0.104740,0.071507,0.094058,0.067589,0.086155,0.081188,0.129944,0.184240,0.137024,0.140008,0.107153,0.107153]
rmse = [0.169414,0.165564,0.181659,0.187513,0.195702,0.183257,0.171615,0.161420,0.152647,0.146249,0.142572,0.140625,0.135741,0.132493,0.136235,0.147367,0.161398,0.177106,0.185054,0.198112,0.213557,0.234184,0.234030,0.230659,0.226703,0.223581,0.222208,0.220924,0.219440,0.215796,0.212366,0.209429,0.206812,0.204387,0.202226,0.200644,0.198573,0.196678,0.194478,0.192606,0.190535,0.188722,0.186925,0.185825,0.185790,0.184866,0.184026,0.182754,0.181526,0.182758,0.184421,0.187927,0.192137,0.197650,0.206277,0.218805,0.232546,0.247080,0.267515,0.290506,0.314209,0.337347,]
time = [1436863806.792117776,1436863806.870120940,1436863806.949103052,1436863807.028725073,1436863807.106115764,1436863807.184128113,1436863807.263141715,1436863807.342147904,1436863807.420182028,1436863807.499126164,1436863807.578112624,1436863807.736118415,1436863807.815117112,1436863807.893176789,1436863807.972116707,1436863808.051109445,1436863808.130170463,1436863808.209126647,1436863808.288311504,1436863808.367164819,1436863808.445338394,1436863808.524154291,1436863808.603105044,1436863808.682108541,1436863808.760115241,1436863808.839258462,1436863808.918169400,1436863808.997106034,1436863809.075110563,1436863809.154157171,1436863809.233108794,1436863809.312127189,1436863809.390134882,1436863809.469116951,1436863809.548265062,1436863809.627186457,1436863809.705121407,1436863809.784132914,1436863809.863151909,1436863809.942128364,1436863810.021129185,1436863810.100210024,1436863810.179133906,1436863810.258846154,1436863810.337146571,1436863810.416120634,1436863810.494113890,1436863810.573209004,1436863810.652125178,1436863810.731123390,1436863810.809315123,1436863810.888327373,1436863810.967122671,1436863811.046120252,1436863811.124114655,1436863811.203135328,1436863811.282761616,1436863811.360186884,1436863811.439155120,1436863811.518177754,1436863811.596139303,1436863811.675121087,]

axarr = plotErrorPlot(name,error,rmse)

axarr[0].axvspan(1, 1.8, color='gray', alpha=0.5)
axarr[0].text((1+1.8)/2, max(error)*1.5*0.9, "occlusion", fontsize = 12, horizontalalignment='center')


saveResult();

name = "precision_tests_walk_slow_01.bag"
error = [0.122791,0.124977,0.106909,0.132644,0.138960,0.140142,0.149861,0.176427,0.199158,0.059140,0.046767,0.028974,0.043791,0.123029,0.109523,0.076756,0.114899,0.131364,0.086318,0.083831,0.072852,0.085665,0.078373,0.090396,0.060948,0.057639,0.050789,0.052888,0.118790,0.125618,0.155553,0.094143,0.110422,0.072995,0.113396,0.142153,0.039758,0.044606,0.054736,0.088172,0.151728,0.112589,0.132506,0.109155,0.135667,0.142817]
rmse = [0.122791,0.123889,0.118499,0.122189,0.125722,0.128238,0.131545,0.137956,0.146028,0.139791,0.134030,0.128596,0.124146,0.124067,0.123151,0.120774,0.120437,0.121070,0.119493,0.117966,0.116216,0.115003,0.113656,0.112783,0.111175,0.109600,0.107995,0.106518,0.106965,0.107639,0.109512,0.109065,0.109106,0.108216,0.108368,0.109447,0.108156,0.106968,0.105951,0.105543,0.106907,0.107046,0.107706,0.107739,0.108438,0.109301,0.113480,0.127307,0.146066,0.168334,0.192658,0.217349,]
time = [1436863363.466863865,1436863363.545604341,1436863363.624605180,1436863363.703612559,1436863363.782619520,1436863363.860621416,1436863363.939768501,1436863364.018626129,1436863364.097625700,1436863364.413631700,1436863364.492655390,1436863364.650678879,1436863364.728617691,1436863364.965626347,1436863365.044610789,1436863365.122669604,1436863365.280619983,1436863365.359649331,1436863365.517628294,1436863365.596613381,1436863365.675695374,1436863365.753629661,1436863365.832609750,1436863365.910627403,1436863365.989632517,1436863366.068633902,1436863366.226623979,1436863366.304621147,1436863366.383659316,1436863366.462616561,1436863366.541722650,1436863366.620608991,1436863366.778659012,1436863366.856611886,1436863367.014670869,1436863367.093622640,1436863367.565637164,1436863367.644625040,1436863367.723624977,1436863367.802629571,1436863367.881639238,1436863367.960631097,1436863368.118680851,1436863368.196624729,1436863368.275857410,1436863368.354619035,1436863368.439739773,1436863368.748619682,1436863368.827721355,1436863368.905632175,1436863368.984632325,1436863369.063619446,]
plotErrorPlotWithTime(name,error,rmse,time)
saveResult();

name = "precision_tests_walk_slow_03.bag"
error = [0.071082,0.071340,0.090912,0.131056,0.128588,0.164558,0.185098,0.213336,0.147797,0.135028,0.188695,0.135833,0.122837,0.115096,0.129156,0.133537,0.114454,0.107012,0.086263,0.104573,0.089321,0.092561,0.126590,0.116097,0.114371,0.193792,0.197480,0.188026,0.155447,0.167328,0.167681,0.165552,0.197228,0.181768,0.189458,0.176521,0.132038,0.154357,0.130134,0.122428,0.141882,0.165993,0.142362,0.135370,0.203751,0.190842,0.187062,0.166181,0.173427]
rmse = [0.071082,0.071211,0.078331,0.094317,0.102096,0.114889,0.127312,0.140966,0.141741,0.141084,0.146055,0.145231,0.143632,0.141784,0.140978,0.140524,0.139126,0.137539,0.135325,0.133955,0.132172,0.130633,0.130459,0.129893,0.129308,0.132370,0.135341,0.137571,0.138225,0.139294,0.140299,0.141157,0.143179,0.144461,0.145939,0.146875,0.146493,0.146706,0.146304,0.145755,0.145662,0.146179,0.146091,0.145856,0.147390,0.148470,0.149395,0.149764,0.150284,0.150993,0.153525,0.156074,0.158488,0.163847,0.171407,0.182103,0.196573,]
plotErrorPlot(name,error,rmse)
saveResult();


name = "precision_tests_walk_very_fast01.bag"
error = [0.102909,0.130096,0.176046,0.129305,0.095364,0.069260,0.066736,0.164497,0.085798,0.105511,0.113664,0.153321,0.126112,0.170803,0.320593,0.206946,0.295378,0.455388,0.586912,0.677759,0.716265,]
rmse = [0.466851,0.388512,0.347785,0.316397,0.291442,0.271090,0.254677,0.246293,0.235224,0.226522,0.219346,0.214989,0.209892,0.207515,0.216321,0.215781,0.220957,0.239096,0.267454,0.300000,0.330498,]
plotErrorPlot(name,error,rmse)
saveResult();


for name, error, rmse in zip(name_lst, error_lst, rmse_lst):
    
    print name
    
    # trim the rmse
    rmse = rmse[0:len(error)]
    
    #calculate the time
    t = np.arange(0,len(error)*0.08, 0.08)
    
    f, axarr = plt.subplots(2, figsize=(15,5))
    
    #plot
    axarr[0].plot(t[0:len(error)],getRMSE(error),'r.-', markersize = 10, label="RMSE")
    axarr[0].set_title("Root mean squared error", fontsize=15)
    axarr[0].set_ylim(0,max(error)*1.5)
    axarr[0].set_xlim(0,max(t))

    axarr[0].plot(t[0:len(error)],error,'b.-', markersize = 10, label="Translational Error")
    axarr[0].legend()
    #plt.subplots_adjust(left=None, bottom=None, right=None, top=2, wspace=None, hspace=0.75)

    axarr[1].boxplot(error)
    axarr[1].set_title("Error distribution", fontsize=15)
    axarr[1].set_xticklabels([])
    axarr[1].set_ylim(0,max(error)*1.5)
    
    plt.suptitle(name, fontsize = 20)
    plt.subplots_adjust(left=None, bottom=None, right=None, top=0.85, wspace=None, hspace=0.4)
    
    #Save the image
    savefig('./output/'+os.path.splitext(name)[0]+'.pdf')
#
#rmse = [0.103596,0.103596,0.103596,0.090355,0.083768,0.077188,0.071798,0.072069,0.077150,0.082247,0.086194,0.089350,0.091935,0.094095,0.095927,0.097503,0.098872,0.100073,0.101135,0.101897,0.101450,0.099892,0.098816,0.097818,0.096892,0.096028,0.098784,0.100588,0.100879,0.099562,0.098146,0.096721,0.095479,0.094990,0.094783,0.093821,0.092780,0.091895,0.091048,0.101978]
#error = [0.103596,0.103596,0.103596,0.021439,0.049285,0.025740,0.018365,0.073936,0.109626,0.118646,0.118646,0.118646,0.118646,0.118646,0.118646,0.118646,0.118646,0.118646,0.118646,0.115418,0.092050,0.058243,0.071120,0.071120,0.071120,0.071120,0.154001,0.140818,0.108703,0.047499,0.035106,0.027406,0.038384,0.077158,0.087436,0.049569,0.040179,0.048971,0.048971]


